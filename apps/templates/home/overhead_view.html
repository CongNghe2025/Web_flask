<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>360 Image Viewer</title>
    <link rel="stylesheet" href="/static/assets/css/pannellum.css">
    <style>
        #panorama {
            width: 100%;
            height: 100vh;
        }
        #time-buttons {
            position: fixed; /* Đổi từ absolute sang fixed */
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            z-index: 1000; /* Đảm bảo các nút nằm trên các thành phần khác */
        }

        #time-buttons button {
            margin: 5px 0;
            padding: 10px 15px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        #time-buttons button:hover {
            background-color: #0056b3;
        }
    </style>
</head>
<body>
    <div id="time-buttons">
        <button onclick="changeView('morning')">Morning</button>

        <button onclick="changeView('evening')">Evening</button>
        <button onclick="changeScene('livingroom')">Go back Livingroom</button>
    </div>
    <div id="panorama"></div>

    <script src="/static/assets/js/pannellum.js"></script>
    <script src="/static/assets/js/libpannellum.js"></script>

    <script>
         const scenes = {
            "livingroom": {
                "morning": "/static/assets/images/livingroom_sang.jpg",
                "evening": "/static/assets/images/livingroom_toi.jpg"
            },
            "bedroom": {
                "morning": "/static/assets/images/bedroom_sang.jpg",
                "evening": "/static/assets/images/bedroom_toi.jpg"
            },
            "workspace": {
                "morning": "/static/assets/images/workspace_sang.jpg",
                "evening": "/static/assets/images/workspace_toi.jpg"
            },
            "kitchen": {
                "morning": "/static/assets/images/kitchen_sang.jpg",
                "evening": "/static/assets/images/kitchen_toi.jpg"
            },
            "bathroom": {
                "morning": "/static/assets/images/bathroom_sang.jpg",
                "evening": "/static/assets/images/bathroom_toi.jpg"
            },
            "yard": {
                "morning": "/static/assets/images/yard_sang.jpg",
                "evening": "/static/assets/images/yard_toi.jpg"
            }
            // Các cảnh khác nếu cần
        };
        let currentScene = "livingroom"; // Cảnh mặc định ban đầu
        let currentTime = "morning"; // Thời gian mặc định ban đầu
        const viewer = pannellum.viewer('panorama', {
            "default": {
                "firstScene": currentScene,
                "author": "Mô hình Việt",
                "sceneFadeDuration": 1000
            },
            "scenes": {
                "livingroom": getSceneConfig("livingroom"),
                "bedroom": getSceneConfig("bedroom"),
                "workspace": getSceneConfig("workspace"),
                "kitchen": getSceneConfig("kitchen"),
                "yard": getSceneConfig("yard"),
                "bathroom": getSceneConfig("bathroom")
            }
        });
        function getSceneConfig(sceneId) {
            return {
                "title": sceneId,
                "hfov": 110,
                "pitch": -3,
                "yaw": 117,
                "type": "equirectangular",
                "panorama": scenes[sceneId][currentTime],
                "hotSpots": getHotSpots(sceneId)
            };
        }
        function getHotSpots(sceneId) {
            const hotSpots = {
                "livingroom": [
                    {
                        "pitch": -2.1,
                        "yaw": 207.9,
                        "type": "scene",
                        "text": "Bedroom",
                        "sceneId": "bedroom",
                        "clickHandlerFunc": () => changeScene('bedroom')
                    },
                    {
                        "pitch": -2.1,
                        "yaw": 160.9,
                        "type": "scene",
                        "text": "Bathroom",
                        "sceneId": "bathroom",
                        "clickHandlerFunc": () => changeScene('bathroom')
                    },
                    {
                        "pitch": -2.1,
                        "yaw": 188.9,
                        "type": "scene",
                        "text": "Workspace",
                        "sceneId": "workspace",
                        "clickHandlerFunc": () => changeScene('workspace')
                    },
                    {
                        "pitch": -2.1,
                        "yaw": 66.9,
                        "type": "scene",
                        "text": "Yard",
                        "sceneId": "yard",
                        "clickHandlerFunc": () => changeScene('yard')
                    },
                    {
                        "pitch": -2.1,
                        "yaw": 212.9,
                        "type": "scene",
                        "text": "Kitchen",
                        "sceneId": "kitchen",
                        "clickHandlerFunc": () => changeScene('kitchen')
                    }
                ],
                "bedroom": [
                    {
                        "pitch": -2.1,
                        "yaw": 250,
                        "type": "scene",
                        "text": "Bathroom",
                        "sceneId": "bathroom",
                        "clickHandlerFunc": () => changeScene('bathroom')
                    },
                    {
                        "pitch": -2.1,
                        "yaw": 200,
                        "type": "scene",
                        "text": "Yard",
                        "sceneId": "yard",
                        "clickHandlerFunc": () => changeScene('yard')
                    }
                ],
                "workspace": [
                    {
                        "pitch": -2.1,
                        "yaw": 240.9,
                        "type": "scene",
                        "text": "LivingRoom",
                        "sceneId": "livingroom",
                        "clickHandlerFunc": () => changeScene('livingroom')
                    },
                    {
                        "pitch": -2.1,
                        "yaw": 45.9,
                        "type": "scene",
                        "text": "Bathroom",
                        "sceneId": "bathroom",
                        "clickHandlerFunc": () => changeScene('bathroom')
                    }
                ],
                "yard": [
                    {
                        "pitch": -2.1,
                        "yaw": 152.9,
                        "type": "scene",
                        "text": "LivingRoom",
                        "sceneId": "livingroom",
                        "clickHandlerFunc": () => changeScene('livingroom')
                    },
                    {
                        "pitch": -2.1,
                        "yaw": 75.9,
                        "type": "scene",
                        "text": "Bedroom",
                        "sceneId": "bedroom",
                        "clickHandlerFunc": () => changeScene('bedroom')
                    }
                ],
                "kitchen": [
                    {
                        "pitch": -2.1,
                        "yaw": 1.9,
                        "type": "scene",
                        "text": "LivingRoom",
                        "sceneId": "livingroom",
                        "clickHandlerFunc": () => changeScene('livingroom')
                    }
                ],
                "bathroom": [
                    {
                        "pitch": -6.1,
                        "yaw": 174.9,
                        "type": "scene",
                        "text": "LivingRoom",
                        "sceneId": "livingroom",
                        "clickHandlerFunc": () => changeScene('livingroom')
                    },
                    {
                        "pitch": -2.1,
                        "yaw": 310.9,
                        "type": "scene",
                        "text": "Bedroom",
                        "sceneId": "bedroom",
                        "clickHandlerFunc": () => changeScene('bedroom')
                    }
                ]
            };
            return hotSpots[sceneId] || [];
        }
        function changeView(time) {
            currentTime = time;
            const newPanorama = scenes[currentScene][currentTime];
            if (newPanorama) {
                const sceneConfig = getSceneConfig(currentScene);
                sceneConfig.panorama = newPanorama;
                viewer.removeScene(currentScene);
                viewer.addScene(currentScene, sceneConfig);
                viewer.loadScene(currentScene);
            } else {
                console.error(`Không tìm thấy ảnh panorama cho cảnh '${currentScene}' vào thời gian '${currentTime}'`);
            }
        }

        function changeScene(sceneId) {
            currentScene = sceneId;
            const newPanorama = scenes[currentScene][currentTime];
            if (newPanorama) {
                const sceneConfig = getSceneConfig(sceneId);
                sceneConfig.panorama = newPanorama;
                viewer.removeScene(sceneId);
                viewer.addScene(sceneId, sceneConfig);
                viewer.loadScene(sceneId);
            } else {
                console.error(`Không tìm thấy ảnh panorama cho cảnh '${sceneId}' vào thời gian '${currentTime}'`);
            }
        }
        
    </script>
</body>
</html>
